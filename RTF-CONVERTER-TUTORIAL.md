# Ø¢Ù…ÙˆØ²Ø´ Ú©Ø§Ù…Ù„ RTF Converter - Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ ØªÙˆØ³Ø¹Ù‡â€ŒØ¯Ù‡Ù†Ø¯Ú¯Ø§Ù†

## ğŸ“š ÙÙ‡Ø±Ø³Øª Ù…Ø·Ø§Ù„Ø¨

1. [Ù…Ù‚Ø¯Ù…Ù‡](#Ù…Ù‚Ø¯Ù…Ù‡)
2. [RTF Ú†ÛŒØ³ØªØŸ](#rtf-Ú†ÛŒØ³Øª)
3. [Ù…Ø¹Ù…Ø§Ø±ÛŒ Ú©Ù„ÛŒ](#Ù…Ø¹Ù…Ø§Ø±ÛŒ-Ú©Ù„ÛŒ)
4. [Ø³Ø§Ø®ØªØ§Ø± RTF](#Ø³Ø§Ø®ØªØ§Ø±-rtf)
5. [Ù†Ø­ÙˆÙ‡ Ù¾Ø±Ø¯Ø§Ø²Ø´ RTF](#Ù†Ø­ÙˆÙ‡-Ù¾Ø±Ø¯Ø§Ø²Ø´-rtf)
6. [ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø´Ø¯Ù‡](#ÙˆÛŒÚ˜Ú¯ÛŒÙ‡Ø§ÛŒ-Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ-Ø´Ø¯Ù‡)
7. [Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø±Ø¯ÛŒ](#Ù…Ø«Ø§Ù„Ù‡Ø§ÛŒ-Ú©Ø§Ø±Ø¨Ø±Ø¯ÛŒ)
8. [Ù†Ú©Ø§Øª Ù¾ÛŒØ´Ø±ÙØªÙ‡](#Ù†Ú©Ø§Øª-Ù¾ÛŒØ´Ø±ÙØªÙ‡)

---

## Ù…Ù‚Ø¯Ù…Ù‡

Ø§ÛŒÙ† Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡ ÛŒÚ© Ù…Ø¨Ø¯Ù„ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ RTF Ø¨Ù‡ HTML Ø§Ø³Øª Ú©Ù‡ Ø¨Ø§ TypeScript Ù†ÙˆØ´ØªÙ‡ Ø´Ø¯Ù‡ Ùˆ Ø§Ø² Ù…ØªÙ†â€ŒÙ‡Ø§ÛŒ ÙØ§Ø±Ø³ÛŒ/Ø¹Ø±Ø¨ÛŒ (Ø¨Ø§ Ú©Ø¯Ú¯Ø°Ø§Ø±ÛŒ Windows-1256) Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù…ÛŒâ€ŒÚ©Ù†Ø¯.

### ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ú©Ù„ÛŒØ¯ÛŒ:
- âœ… Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ú©Ø§Ù…Ù„ Ø§Ø² ÙØ§Ø±Ø³ÛŒ Ùˆ Ø¹Ø±Ø¨ÛŒ
- âœ… ØªØ¨Ø¯ÛŒÙ„ Ø¯ÙˆØ·Ø±ÙÙ‡: RTF â†” HTML
- âœ… Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø§Ø² Ø¬Ø¯Ø§ÙˆÙ„ØŒ Ù„ÛŒØ³Øªâ€ŒÙ‡Ø§ØŒ Ø±Ù†Ú¯â€ŒÙ‡Ø§ØŒ ÙÙˆÙ†Øªâ€ŒÙ‡Ø§
- âœ… Ù…Ø¯ÛŒØ±ÛŒØª Ø­Ø§ÙØ¸Ù‡ Ø¨Ù‡ÛŒÙ†Ù‡
- âœ… ØªØ³Øª Ùˆ Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ Ú©Ø§Ù…Ù„

---

## RTF Ú†ÛŒØ³ØªØŸ

**RTF (Rich Text Format)** ÛŒÚ© ÙØ±Ù…Øª Ù…ØªÙ†ÛŒ Ø§Ø³Øª Ú©Ù‡ ØªÙˆØ³Ø· Ù…Ø§ÛŒÚ©Ø±ÙˆØ³Ø§ÙØª ØªÙˆØ³Ø¹Ù‡ Ø¯Ø§Ø¯Ù‡ Ø´Ø¯Ù‡ Ùˆ Ø¨Ø±Ø§ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ø§Ø³Ù†Ø§Ø¯ Ø¨Ø§ Ù‚Ø§Ù„Ø¨â€ŒØ¨Ù†Ø¯ÛŒ (ÙÙˆÙ†ØªØŒ Ø±Ù†Ú¯ØŒ Ù„ÛŒØ³ØªØŒ Ø¬Ø¯ÙˆÙ„ Ùˆ...) Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯.

### Ø³Ø§Ø®ØªØ§Ø± Ø§ØµÙ„ÛŒ ÛŒÚ© ÙØ§ÛŒÙ„ RTF:

```rtf
{\rtf1\ansi\deff0
  {\fonttbl{\f0 Arial;}}
  {\colortbl ;\red255\green0\blue0;}
  \f0\fs24 Hello \b World\b0
}
```

**ØªÙˆØ¶ÛŒØ­:**
- `{\rtf1...}` - Ù‡Ù…Ù‡ Ú†ÛŒØ² Ø¯Ø§Ø®Ù„ Ø¨Ø±Ø§Ú©Øªâ€ŒÙ‡Ø§ Ù‚Ø±Ø§Ø± Ø¯Ø§Ø±Ø¯
- `\ansi` - Ù†ÙˆØ¹ Ú©Ø¯Ú¯Ø°Ø§Ø±ÛŒ Ú©Ø§Ø±Ø§Ú©ØªØ±
- `{\fonttbl...}` - Ø¬Ø¯ÙˆÙ„ ÙÙˆÙ†Øªâ€ŒÙ‡Ø§
- `{\colortbl...}` - Ø¬Ø¯ÙˆÙ„ Ø±Ù†Ú¯â€ŒÙ‡Ø§
- `\b` - Ø´Ø±ÙˆØ¹ bold
- `\b0` - Ù¾Ø§ÛŒØ§Ù† bold

---

## Ù…Ø¹Ù…Ø§Ø±ÛŒ Ú©Ù„ÛŒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           RTF Document (Input)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Validation & Parsing               â”‚
â”‚  - Ø¨Ø±Ø±Ø³ÛŒ Ø¨Ø±Ø§Ú©Øªâ€ŒÙ‡Ø§                          â”‚
â”‚  - Ø¨Ø±Ø±Ø³ÛŒ Ø­Ø¬Ù… ÙØ§ÛŒÙ„                          â”‚
â”‚  - ØªØ¬Ø²ÛŒÙ‡ Control Words                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           State Management                  â”‚
â”‚  - Font Table                                â”‚
â”‚  - Color Table                               â”‚
â”‚  - Formatting State Stack                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         HTML Generation                     â”‚
â”‚  - ØªÙˆÙ„ÛŒØ¯ ØªÚ¯â€ŒÙ‡Ø§ÛŒ HTML                       â”‚
â”‚  - Ø§Ø¹Ù…Ø§Ù„ Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§                         â”‚
â”‚  - Ù¾Ø§Ú©Ø³Ø§Ø²ÛŒ ØªÚ¯â€ŒÙ‡Ø§ÛŒ Ø®Ø§Ù„ÛŒ                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         HTML Output (Clean & Valid)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Ø³Ø§Ø®ØªØ§Ø± RTF

### 1. Control Words (Ø¯Ø³ØªÙˆØ±Ø§Øª Ú©Ù†ØªØ±Ù„ÛŒ)

Control Word Ù‡Ø§ Ø¨Ø§ `\` Ø´Ø±ÙˆØ¹ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ Ùˆ Ø±ÙØªØ§Ø± Ù…ØªÙ† Ø±Ø§ ØªØ¹ÛŒÛŒÙ† Ù…ÛŒâ€ŒÚ©Ù†Ù†Ø¯:

```rtf
\b          â†’ Bold Ø´Ø±ÙˆØ¹
\b0         â†’ Bold Ù¾Ø§ÛŒØ§Ù†
\i          â†’ Italic Ø´Ø±ÙˆØ¹
\fs24       â†’ Font Size = 24/2 = 12pt
\cf1        â†’ Ø±Ù†Ú¯ Ø´Ù…Ø§Ø±Ù‡ 1 Ø§Ø² Ø¬Ø¯ÙˆÙ„ Ø±Ù†Ú¯
\par        â†’ Ù¾Ø§Ø±Ø§Ú¯Ø±Ø§Ù Ø¬Ø¯ÛŒØ¯
\line       â†’ Ø®Ø· Ø¬Ø¯ÛŒØ¯
\tab        â†’ Tab
```

### 2. Groups (Ú¯Ø±ÙˆÙ‡â€ŒÙ‡Ø§)

Ù‡Ø± Ú†ÛŒØ²ÛŒ Ú©Ù‡ Ø¨ÛŒÙ† `{` Ùˆ `}` Ø¨Ø§Ø´Ø¯ ÛŒÚ© Ú¯Ø±ÙˆÙ‡ Ø§Ø³Øª:

```rtf
{\b bold text}     â†’ ÙÙ‚Ø· Ø§ÛŒÙ† Ù…ØªÙ† bold Ø§Ø³Øª
normal text        â†’ Ø§ÛŒÙ† Ù…ØªÙ† Ø¹Ø§Ø¯ÛŒ Ø§Ø³Øª
```

### 3. Hex Escape (Ú©Ø§Ø±Ø§Ú©ØªØ±Ù‡Ø§ÛŒ Ø®Ø§Øµ)

Ú©Ø§Ø±Ø§Ú©ØªØ±Ù‡Ø§ÛŒ ØºÛŒØ±-ASCII Ø¨Ø§ `\'XX` Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯:

```rtf
\'ca\'da\'e5\'cf   â†’ ØªØ¹Ù‡Ø¯ (ÙØ§Ø±Ø³ÛŒ Ø¯Ø± Windows-1256)
```

### 4. Unicode

Ú©Ø§Ø±Ø§Ú©ØªØ±Ù‡Ø§ÛŒ ÛŒÙˆÙ†ÛŒÚ©Ø¯:

```rtf
\u1740?    â†’ Ú©Ø§Ø±Ø§Ú©ØªØ± ÛŒÙˆÙ†ÛŒÚ©Ø¯ 1740 (ÛŒ ÙØ§Ø±Ø³ÛŒ)
           â†’ ? ÛŒÚ© fallback Ø¨Ø±Ø§ÛŒ Ù†Ø±Ù…â€ŒØ§ÙØ²Ø§Ø±Ù‡Ø§ÛŒ Ù‚Ø¯ÛŒÙ…ÛŒ Ø§Ø³Øª
```

---

## Ù†Ø­ÙˆÙ‡ Ù¾Ø±Ø¯Ø§Ø²Ø´ RTF

### 1. **Tokenization (ØªÙˆÚ©Ù† Ø³Ø§Ø²ÛŒ)**

Ù…Ø«Ø§Ù„ RTF:
```rtf
{\rtf1 Hello \b World\b0}
```

ØªÙˆÚ©Ù†â€ŒÙ‡Ø§ÛŒ ØªÙˆÙ„ÛŒØ¯ Ø´Ø¯Ù‡:
```javascript
[
  '{',
  '\\rtf1',
  'Hello',
  '\\b',
  'World',
  '\\b0',
  '}'
]
```

### 2. **State Stack (Ù¾Ø´ØªÙ‡ Ø­Ø§Ù„Øª)**

```javascript
interface RtfState {
  bold: boolean;
  italic: boolean;
  underline: boolean;
  fontSize: number | null;
  font: string | null;
  color: string | null;
  // ... Ø³Ø§ÛŒØ± ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§
}
```

**Ú†Ø±Ø§ StackØŸ**
Ú†ÙˆÙ† RTF Ø§Ø² Ú¯Ø±ÙˆÙ‡â€ŒÙ‡Ø§ÛŒ ØªÙˆØ¯Ø±ØªÙˆ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†Ø¯:

```rtf
{normal {bold text} normal again}
```

ÙˆÙ‚ØªÛŒ `{` Ù…ÛŒâ€ŒØ¨ÛŒÙ†ÛŒÙ… â†’ Ø­Ø§Ù„Øª ÙØ¹Ù„ÛŒ Ø±Ø§ push Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ…
ÙˆÙ‚ØªÛŒ `}` Ù…ÛŒâ€ŒØ¨ÛŒÙ†ÛŒÙ… â†’ Ø­Ø§Ù„Øª Ù‚Ø¨Ù„ÛŒ Ø±Ø§ pop Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ…

### 3. **Font Table Processing**

```rtf
{\fonttbl
  {\f0\fnil Arial;}
  {\f1\fnil Times New Roman;}
}
```

ØªØ¨Ø¯ÛŒÙ„ Ø¨Ù‡:
```javascript
fontTable = {
  0: "Arial",
  1: "Times New Roman"
}
```

Ø¨Ø¹Ø¯Ø§Ù‹ Ø¯Ø± Ù…ØªÙ†:
```rtf
\f0 This is Arial
\f1 This is Times
```

### 4. **Color Table Processing**

```rtf
{\colortbl
  ;                           â† Ø±Ù†Ú¯ 0 (Ù¾ÛŒØ´â€ŒÙØ±Ø¶)
  \red255\green0\blue0;       â† Ø±Ù†Ú¯ 1 (Ù‚Ø±Ù…Ø²)
  \red0\green255\blue0;       â† Ø±Ù†Ú¯ 2 (Ø³Ø¨Ø²)
}
```

ØªØ¨Ø¯ÛŒÙ„ Ø¨Ù‡:
```javascript
colorTable = [
  null,
  "rgb(255,0,0)",
  "rgb(0,255,0)"
]
```

---

## ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø´Ø¯Ù‡

### 1. **Text Formatting (Ù‚Ø§Ù„Ø¨â€ŒØ¨Ù†Ø¯ÛŒ Ù…ØªÙ†)**

```rtf
\b Bold text\b0
\i Italic text\i0
\ul Underline text\ul0
\fs24 Font size 12pt
```

â†’ HTML:
```html
<strong>Bold text</strong>
<em>Italic text</em>
<u>Underline text</u>
<span style="font-size:12pt">Font size 12pt</span>
```

### 2. **Paragraph Alignment (ØªØ±Ø§Ø² Ù¾Ø§Ø±Ø§Ú¯Ø±Ø§Ù)**

```rtf
\qr Right aligned
\qc Center aligned
\ql Left aligned
\qj Justified
```

â†’ HTML:
```html
<p style="text-align:right">Right aligned</p>
<p style="text-align:center">Center aligned</p>
```

### 3. **Lists (Ù„ÛŒØ³Øªâ€ŒÙ‡Ø§)**

```rtf
{\pntext Â·\tab}First item\par
{\pntext Â·\tab}Second item\par
```

â†’ HTML:
```html
<ul>
  <li>First item</li>
  <li>Second item</li>
</ul>
```

**Ù†Ú©ØªÙ‡ Ù…Ù‡Ù…:** `\pntext` group Ø´Ø§Ù…Ù„ bullet marker Ø§Ø³Øª Ú©Ù‡ Ø¨Ø§ÛŒØ¯ ignore Ø´ÙˆØ¯.

### 4. **Tables (Ø¬Ø¯Ø§ÙˆÙ„)**

```rtf
\trowd              â† Ø´Ø±ÙˆØ¹ ØªØ¹Ø±ÛŒÙ Ø³Ø·Ø±
\cellx1000          â† Ø¹Ø±Ø¶ Ø³ØªÙˆÙ† Ø§ÙˆÙ„ = 1000 twips
\cellx2000          â† Ø¹Ø±Ø¶ Ø³ØªÙˆÙ† Ø¯ÙˆÙ… = 2000 twips
\intbl Cell 1\cell  â† Ù…Ø­ØªÙˆØ§ÛŒ Ø³Ù„ÙˆÙ„ Ø§ÙˆÙ„
\intbl Cell 2\cell  â† Ù…Ø­ØªÙˆØ§ÛŒ Ø³Ù„ÙˆÙ„ Ø¯ÙˆÙ…
\row                â† Ù¾Ø§ÛŒØ§Ù† Ø³Ø·Ø±
```

â†’ HTML:
```html
<table>
  <tr>
    <td>Cell 1</td>
    <td>Cell 2</td>
  </tr>
</table>
```

**ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÙˆÙ„:**
- `\clbrdrt` - Border Ø¨Ø§Ù„Ø§
- `\clbrdrb` - Border Ù¾Ø§ÛŒÛŒÙ†
- `\clbrdrl` - Border Ú†Ù¾
- `\clbrdrr` - Border Ø±Ø§Ø³Øª
- `\clmgf` - Ø§ÙˆÙ„ÛŒÙ† Ø³Ù„ÙˆÙ„ merged
- `\clmrg` - Ø³Ù„ÙˆÙ„ merged Ø¨Ø§ Ù‚Ø¨Ù„ÛŒ
- `\clvertalt` - ØªØ±Ø§Ø² Ø¹Ù…ÙˆØ¯ÛŒ Ø¨Ø§Ù„Ø§
- `\clvertalc` - ØªØ±Ø§Ø² Ø¹Ù…ÙˆØ¯ÛŒ ÙˆØ³Ø·
- `\clvertalb` - ØªØ±Ø§Ø² Ø¹Ù…ÙˆØ¯ÛŒ Ù¾Ø§ÛŒÛŒÙ†

### 5. **Space & Tab Handling**

**Ù…Ø´Ú©Ù„ Ø§ÙˆÙ„ÛŒÙ‡:**
```
Space Ù…Ø¹Ù…ÙˆÙ„ÛŒ Ø¯Ø± HTML collapse Ù…ÛŒâ€ŒØ´ÙˆØ¯
```

**Ø±Ø§Ù‡â€ŒØ­Ù„:**
```javascript
.replace(/ /g, '&nbsp;')     // ØªÙ…Ø§Ù… spaceÙ‡Ø§ Ø¨Ù‡ &nbsp;
.replace(/\t/g, '&nbsp;'.repeat(8))  // Tab = 8 nbsp
```

**Round-trip:**
```javascript
// HTML â†’ RTF
.replace(/(&nbsp;){8}/g, '\t')  // 8 nbsp Ø¨Ù‡ tab
.replace(/&nbsp;/g, ' ')         // Ø¨Ù‚ÛŒÙ‡ Ø¨Ù‡ space
```

### 6. **Persian/Arabic Support**

**Windows-1256 Mapping:**
```javascript
const win1256 = {
  0xCA: 0x062A,  // Øª
  0xCD: 0x062D,  // Ø­
  // ... 256 Ù…ÙˆØ±Ø¯
};
```

**Unicode Escape:**
```rtf
\u1578?  â†’ Øª (Unicode 1578)
```

---

## Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø±Ø¯ÛŒ

### Ù…Ø«Ø§Ù„ 1: Ù…ØªÙ† Ø³Ø§Ø¯Ù‡ Ø¨Ø§ Ù‚Ø§Ù„Ø¨â€ŒØ¨Ù†Ø¯ÛŒ

**RTF:**
```rtf
{\rtf1\ansi
Hello \b World\b0!
\par
This is \i italic\i0 text.
}
```

**ÙØ±Ø¢ÛŒÙ†Ø¯ Ù¾Ø±Ø¯Ø§Ø²Ø´:**

1. Ø®ÙˆØ§Ù†Ø¯Ù† `{\rtf1\ansi` â†’ Ø´Ø±ÙˆØ¹ Ø³Ù†Ø¯
2. Ø®ÙˆØ§Ù†Ø¯Ù† `Hello` â†’ appendText("Hello")
3. Ø®ÙˆØ§Ù†Ø¯Ù† `\b` â†’ state.bold = true
4. flushText() â†’ `<span>Hello</span>`
5. Ø®ÙˆØ§Ù†Ø¯Ù† `World` â†’ appendText("World")
6. Ø®ÙˆØ§Ù†Ø¯Ù† `\b0` â†’ state.bold = false
7. flushText() â†’ `<span><strong>World</strong></span>`

**HTML Ø®Ø±ÙˆØ¬ÛŒ:**
```html
<div dir="rtl" style="text-align:right">
  <p>Hello&nbsp;<span><strong>World</strong></span>!</p>
  <br/>
  <p>This&nbsp;is&nbsp;<span><em>italic</em></span>&nbsp;text.</p>
</div>
```

### Ù…Ø«Ø§Ù„ 2: Ø¬Ø¯ÙˆÙ„ Ø¨Ø§ Ø¨ÙˆØ±Ø¯Ø±

**RTF:**
```rtf
{\rtf1
\trowd
\clbrdrt\clbrdrb\clbrdrl\clbrdrr
\cellx1440
\clbrdrt\clbrdrb\clbrdrl\clbrdrr
\cellx2880
\pard\intbl Cell 1\cell
\pard\intbl Cell 2\cell
\row
}
```

**Ù¾Ø±Ø¯Ø§Ø²Ø´:**

```javascript
// \trowd â†’ Ø´Ø±ÙˆØ¹ Ø¬Ø¯ÙˆÙ„
if (!inTable) {
  output.push('<table style="border-collapse:collapse">');
  inTable = true;
}
output.push('<tr>');

// \clbrdrt, \clbrdrb, ... â†’ Ø°Ø®ÛŒØ±Ù‡ border properties
currentCellProps.borders = {
  top: true, bottom: true, left: true, right: true
};

// \cellx1440 â†’ Ø¹Ø±Ø¶ Ø³Ù„ÙˆÙ„
currentCellProps.width = 1440; // twips
cellPropsArray.push({...currentCellProps});

// \intbl Cell 1 â†’ Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ø³Ù„ÙˆÙ„
let cellStyle = 'padding:5px;';
cellStyle += 'border-top:1px solid #000;';
cellStyle += 'border-bottom:1px solid #000;';
cellStyle += 'border-left:1px solid #000;';
cellStyle += 'border-right:1px solid #000;';
// ØªØ¨Ø¯ÛŒÙ„ twips Ø¨Ù‡ pixel: 1440 * 96 / 1440 = 96px
cellStyle += 'width:96px;';

output.push(`<td style="${cellStyle}">Cell 1`);

// \cell â†’ Ø¨Ø³ØªÙ† Ø³Ù„ÙˆÙ„
output.push('</td>');

// \row â†’ Ø¨Ø³ØªÙ† Ø³Ø·Ø±
output.push('</tr>');
```

### Ù…Ø«Ø§Ù„ 3: Ù…ØªÙ† ÙØ§Ø±Ø³ÛŒ

**RTF:**
```rtf
{\rtf1\ansi\ansicpg1256
\f0\fs24 \'d3\'e1\'c7\'e3
}
```

**Ù¾Ø±Ø¯Ø§Ø²Ø´ Hex:**

```javascript
// \'d3 â†’ byte 0xD3
const byte = parseInt("d3", 16); // = 211

// Windows-1256 mapping
win1256[0xD3] = 0x0633; // Ø³

// ØªØ¨Ø¯ÛŒÙ„ Ø¨Ù‡ Ú©Ø§Ø±Ø§Ú©ØªØ±
String.fromCharCode(0x0633); // "Ø³"
```

**ÛŒØ§ Ø¨Ø§ Unicode:**
```rtf
{\rtf1
\u1587?\u1604?\u1575?\u1605?
}
```

```javascript
// \u1587? â†’ Unicode 1587
String.fromCharCode(1587); // "Ø³"
```

---

## Ù†Ú©Ø§Øª Ù¾ÛŒØ´Ø±ÙØªÙ‡

### 1. **Optimization: flushText()**

**Ú†Ø±Ø§ flushText Ø¯Ø§Ø±ÛŒÙ…ØŸ**

```javascript
// Ø¨Ø¯ÙˆÙ† flush:
"Hello \b World\b0" â†’ "<span>Hello <strong>World</strong></span>"
// âŒ Ø§Ø´ØªØ¨Ø§Ù‡! bold ÙÙ‚Ø· Ø¨Ø±Ø§ÛŒ World Ø§Ø³Øª

// Ø¨Ø§ flush:
flushText();  // Ù‚Ø¨Ù„ Ø§Ø² \b â†’ "<span>Hello</span>"
state.bold = true;
flushText();  // Ø¨Ø¹Ø¯ Ø§Ø² \b0 â†’ "<span><strong>World</strong></span>"
// âœ… Ø¯Ø±Ø³Øª!
```

### 2. **Ignorable Destinations**

Ø¨Ø±Ø®ÛŒ group Ù‡Ø§ Ø¨Ø§ÛŒØ¯ Ù†Ø§Ø¯ÛŒØ¯Ù‡ Ú¯Ø±ÙØªÙ‡ Ø´ÙˆÙ†Ø¯:

```rtf
{\*\generator Microsoft Word 16}
```

`\*` ÛŒØ¹Ù†ÛŒ: Ø§Ú¯Ø± Ø§ÛŒÙ† Ø¯Ø³ØªÙˆØ± Ø±Ø§ Ù†Ù…ÛŒâ€ŒØ´Ù†Ø§Ø³ÛŒØŒ Ú©Ù„ group Ø±Ø§ ignore Ú©Ù†.

```javascript
if (rtf[i+1] === '\\' && rtf[i+2] === '*') {
  // Ù¾Ø±Ø´ Ø§Ø² Ú©Ù„ group
  let depth = 1;
  while (depth > 0) {
    i++;
    if (rtf[i] === '{') depth++;
    if (rtf[i] === '}') depth--;
  }
}
```

### 3. **Look-ahead Ø¨Ø±Ø§ÛŒ ØªØ´Ø®ÛŒØµ Ø§Ø¯Ø§Ù…Ù‡ Ø¬Ø¯ÙˆÙ„**

```javascript
// Ø¢ÛŒØ§ \pard Ø¬Ø¯ÙˆÙ„ Ø±Ø§ ØªÙ…Ø§Ù… Ù…ÛŒâ€ŒÚ©Ù†Ø¯ØŸ
let isTableEnd = true;
for (let j = i; j < i + 100; j++) {
  if (findWord(j) === 'trowd' || findWord(j) === 'intbl') {
    isTableEnd = false; // Ù†Ù‡ØŒ Ø¬Ø¯ÙˆÙ„ Ø§Ø¯Ø§Ù…Ù‡ Ø¯Ø§Ø±Ø¯
    break;
  }
}
```

### 4. **Memory Management**

```javascript
// Ø¨Ø¯: Ø°Ø®ÛŒØ±Ù‡ ØªÙ…Ø§Ù… state history
const allStates = [];
while (...) {
  allStates.push(clone(state)); // âŒ Ø­Ø§ÙØ¸Ù‡ Ø²ÛŒØ§Ø¯
}

// Ø®ÙˆØ¨: Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² stack
const stateStack = [initialState];
when '{': stateStack.push(clone(current));
when '}': stateStack.pop();
```

### 5. **HTML Entity Encoding**

**Ú†Ø±Ø§ Ù‡Ù…Ù‡ space Ù‡Ø§ Ø±Ø§ Ø¨Ù‡ `&nbsp;` ØªØ¨Ø¯ÛŒÙ„ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ…ØŸ**

```html
<!-- Ø¨Ø¯ÙˆÙ† encoding: -->
<p>Hello     World</p>
â†’ Ø¯Ø± Ù…Ø±ÙˆØ±Ú¯Ø±: "Hello World" (ÙÙ‚Ø· ÛŒÚ© space!)

<!-- Ø¨Ø§ encoding: -->
<p>Hello&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;World</p>
â†’ Ø¯Ø± Ù…Ø±ÙˆØ±Ú¯Ø±: "Hello     World" (5 space!)
```

### 6. **Tab to Non-breaking Spaces**

```javascript
// Tab = 8 non-breaking spaces
.replace(/\t/g, '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;')

// Round-trip: HTML â†’ RTF
.replace(/(&nbsp;){8}/g, '\\tab ')
```

---

## Ø§Ù„Ú¯ÙˆØ±ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ú©Ù„ÛŒØ¯ÛŒ

### Ø§Ù„Ú¯ÙˆØ±ÛŒØªÙ… 1: Parse Control Word

```javascript
function parseControlWord(rtf, i) {
  let word = '';
  let param = null;
  
  // Ø®ÙˆØ§Ù†Ø¯Ù† Ø­Ø±ÙˆÙ (a-z)
  while (/[a-z]/i.test(rtf[i])) {
    word += rtf[i];
    i++;
  }
  
  // Ø®ÙˆØ§Ù†Ø¯Ù† Ù¾Ø§Ø±Ø§Ù…ØªØ± Ø¹Ø¯Ø¯ÛŒ
  if (rtf[i] === '-' || /\d/.test(rtf[i])) {
    let numStr = '';
    if (rtf[i] === '-') {
      numStr += '-';
      i++;
    }
    while (/\d/.test(rtf[i])) {
      numStr += rtf[i];
      i++;
    }
    param = parseInt(numStr);
  }
  
  // space Ø§Ø®ØªÛŒØ§Ø±ÛŒ Ø¨Ø¹Ø¯ Ø§Ø² control word
  if (rtf[i] === ' ') i++;
  
  return { word, param, nextIndex: i };
}
```

### Ø§Ù„Ú¯ÙˆØ±ÛŒØªÙ… 2: Build HTML Style

```javascript
function stateToStyle(state, colorTable) {
  const styles = [];
  
  if (state.font) {
    styles.push(`font-family:${state.font}`);
  }
  
  if (state.fontSize) {
    styles.push(`font-size:${state.fontSize}pt`);
  }
  
  if (state.colorIndex > 0) {
    const color = colorTable[state.colorIndex];
    if (color) styles.push(`color:${color}`);
  }
  
  return styles.length > 0 
    ? ` style="${styles.join(';')}"` 
    : '';
}
```

### Ø§Ù„Ú¯ÙˆØ±ÛŒØªÙ… 3: Clean Empty Tags

```javascript
function cleanupEmptyTags(html) {
  let cleaned = html;
  let prevCleaned = '';
  
  // ØªÚ©Ø±Ø§Ø± ØªØ§ Ø²Ù…Ø§Ù†ÛŒ Ú©Ù‡ ØªØºÛŒÛŒØ±ÛŒ Ù†Ø¨Ø§Ø´Ø¯
  while (cleaned !== prevCleaned) {
    prevCleaned = cleaned;
    
    // Ø­Ø°Ù ØªÚ¯â€ŒÙ‡Ø§ÛŒ Ø®Ø§Ù„ÛŒ
    cleaned = cleaned
      .replace(/<(strong|em|u|span[^>]*)>\s*<\/\1>/g, '')
      .replace(/<span[^>]*>\s*<\/span>/g, '');
  }
  
  // ØªØ¨Ø¯ÛŒÙ„ Ù¾Ø§Ø±Ø§Ú¯Ø±Ø§Ùâ€ŒÙ‡Ø§ÛŒ Ø®Ø§Ù„ÛŒ Ø¨Ù‡ <br/>
  cleaned = cleaned.replace(/<p[^>]*>\s*<\/p>/g, '<br/>');
  
  return cleaned;
}
```

---

## Ù†Ú©Ø§Øª Performance

### 1. String Concatenation

```javascript
// Ø¨Ø¯:
let html = '';
for (...) {
  html += '<span>text</span>'; // âŒ Ú©Ù†Ø¯ Ø¨Ø±Ø§ÛŒ Ø§Ø³Ù†Ø§Ø¯ Ø¨Ø²Ø±Ú¯
}

// Ø®ÙˆØ¨:
const buffer = [];
for (...) {
  buffer.push('<span>text</span>'); // âœ… Ø³Ø±ÛŒØ¹
}
const html = buffer.join('');
```

### 2. Regex Optimization

```javascript
// Ø¨Ø¯:
html = html.replace(/\s+/g, ' ');      // Ø§ÙˆÙ„
html = html.replace(/<br>/g, '<br/>'); // Ø¯ÙˆÙ…
html = html.replace(/&/g, '&amp;');    // Ø³ÙˆÙ…

// Ø®ÙˆØ¨: Ù‡Ù…Ù‡ Ø¯Ø± ÛŒÚ© pass
html = html
  .replace(/\s+/g, ' ')
  .replace(/<br>/g, '<br/>')
  .replace(/&/g, '&amp;');
```

### 3. Early Exit

```javascript
// Ø¨Ø¯:
for (let i = 0; i < len; i++) {
  if (someCondition) {
    // Ú©Ø§Ø±ÛŒ Ø§Ù†Ø¬Ø§Ù… Ø¨Ø¯Ù‡
  }
}

// Ø®ÙˆØ¨:
for (let i = 0; i < len; i++) {
  if (!someCondition) continue; // skip Ø³Ø±ÛŒØ¹
  // Ú©Ø§Ø±ÛŒ Ø§Ù†Ø¬Ø§Ù… Ø¨Ø¯Ù‡
}
```

---

## ØªØ³Øª Ùˆ Debug

### Ú†Ø§Ù¾ State Ø¨Ø±Ø§ÛŒ Debug:

```javascript
function debugState(state, position) {
  console.log(`Position ${position}:`, {
    bold: state.bold,
    italic: state.italic,
    font: state.font,
    fontSize: state.fontSize,
    inTable: state.inTable
  });
}
```

### ØªØ³Øª Round-trip:

```javascript
const rtf = '{\rtf1 Test}';
const html = rtfToHtml(rtf);
const rtfBack = htmlToRtf(html);
const htmlBack = rtfToHtml(rtfBack);

console.log('Original HTML:', html);
console.log('Round-trip HTML:', htmlBack);
console.log('Match:', html === htmlBack); // Ø¨Ø§ÛŒØ¯ true Ø¨Ø§Ø´Ø¯
```

---

## Ù…Ù†Ø§Ø¨Ø¹ Ùˆ Ù…Ø±Ø§Ø¬Ø¹

1. **RTF Specification 1.9.1**
   - [Microsoft RTF Spec](https://www.microsoft.com/en-us/download/details.aspx?id=10725)

2. **Windows-1256 Encoding**
   - Ø¬Ø¯ÙˆÙ„ Ú©Ø§Ø±Ø§Ú©ØªØ± ÙØ§Ø±Ø³ÛŒ/Ø¹Ø±Ø¨ÛŒ

3. **Twips Unit**
   - 1 inch = 1440 twips
   - 1 point = 20 twips
   - Ø¨Ù‡ pixel: `twips * 96 / 1440`

---

## Ø®Ù„Ø§ØµÙ‡ Ù†Ú©Ø§Øª Ù…Ù‡Ù…

1. âœ… Ù‡Ù…ÛŒØ´Ù‡ Ø§Ø² Stack Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª state Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†
2. âœ… Ù‚Ø¨Ù„ Ø§Ø² ØªØºÛŒÛŒØ± stateØŒ flushText() Ø±Ø§ ÙØ±Ø§Ø®ÙˆØ§Ù†ÛŒ Ú©Ù†
3. âœ… control word Ù‡Ø§ÛŒ Ù†Ø§Ø´Ù†Ø§Ø®ØªÙ‡ Ø±Ø§ ignore Ú©Ù† (Ø¯Ø± non-strict mode)
4. âœ… Ù‡Ù…Ù‡ space Ù‡Ø§ Ø±Ø§ Ø¨Ù‡ `&nbsp;` ØªØ¨Ø¯ÛŒÙ„ Ú©Ù†
5. âœ… Ø§Ø² Buffer Ø¨Ø±Ø§ÛŒ concatenation Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†
6. âœ… Look-ahead Ø¨Ø±Ø§ÛŒ ØªØ´Ø®ÛŒØµ Ø§Ø¯Ø§Ù…Ù‡ Ø³Ø§Ø®ØªØ§Ø±Ù‡Ø§ (Ø¬Ø¯ÙˆÙ„ØŒ Ù„ÛŒØ³Øª)
7. âœ… Round-trip Ø±Ø§ ØªØ³Øª Ú©Ù†
8. âœ… Windows-1256 Ø¨Ø±Ø§ÛŒ ÙØ§Ø±Ø³ÛŒ Ø¶Ø±ÙˆØ±ÛŒ Ø§Ø³Øª

---

## ØªÙ…Ø±ÛŒÙ†: ÛŒÚ© Converter Ø³Ø§Ø¯Ù‡ Ø¨Ù†ÙˆÛŒØ³

```javascript
function simpleRtfToHtml(rtf) {
  let html = '';
  let bold = false;
  
  for (let i = 0; i < rtf.length; i++) {
    if (rtf[i] === '\\') {
      i++; // skip backslash
      
      // Ø®ÙˆØ§Ù†Ø¯Ù† control word
      let word = '';
      while (/[a-z]/i.test(rtf[i])) {
        word += rtf[i];
        i++;
      }
      
      if (word === 'b') {
        if (bold) html += '</strong>';
        html += '<strong>';
        bold = true;
      } else if (word === 'b0') {
        if (bold) html += '</strong>';
        bold = false;
      } else if (word === 'par') {
        html += '<br/>';
      }
    } else if (rtf[i] === '{' || rtf[i] === '}') {
      // skip braces
    } else {
      html += rtf[i];
    }
  }
  
  return html;
}

// ØªØ³Øª
const rtf = '{\\rtf1 Hello \\b World\\b0}';
console.log(simpleRtfToHtml(rtf));
// Output: Hello <strong>World</strong>
```

---

**Ù…ÙˆÙÙ‚ Ø¨Ø§Ø´ÛŒØ¯! ğŸš€**

Ø§Ú¯Ø± Ø³ÙˆØ§Ù„ÛŒ Ø¯Ø§Ø´ØªÛŒØ¯ØŒ Ø¯Ø± Issues Ú¯ÛŒØªâ€ŒÙ‡Ø§Ø¨ Ø¨Ù¾Ø±Ø³ÛŒØ¯.
